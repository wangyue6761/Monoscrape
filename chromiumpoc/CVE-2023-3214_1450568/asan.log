=================================================================
 ==6220==ERROR: AddressSanitizer: heap-use-after-free on address 0x0038954d7458 at pc 0x007156069094 bp 0x007fc073c0b0 sp 0x007fc073c0a8
 READ of size 8 at 0x0038954d7458 thread T0 (chromium.chrome)
     #0 0x7c1c090 base::raw_ptr<autofill::AutofillSnackbarController, (base::RawPtrTraits)0>::GetForDereference() const @ './../../base/allocator/partition_allocator/pointers/raw_ptr.h:1044:48'
     #1 0x72ffa1a354  (/apex/com.android.art/lib64/libart.so+0x21a354) (BuildId: 0c537e5efe426a30e9fde84241db9e3e)
     #2 0x72ffa09a9c  (/apex/com.android.art/lib64/libart.so+0x209a9c) (BuildId: 0c537e5efe426a30e9fde84241db9e3e)
     #3 0x72ffa0b074  (/apex/com.android.art/lib64/libart.so+0x20b074) (BuildId: 0c537e5efe426a30e9fde84241db9e3e)
     #4 0x72ffa0a254  (/apex/com.android.art/lib64/libart.so+0x20a254) (BuildId: 0c537e5efe426a30e9fde84241db9e3e)
     #5 0x72ffa0b074  (/apex/com.android.art/lib64/libart.so+0x20b074) (BuildId: 0c537e5efe426a30e9fde84241db9e3e)
     #6 0x72ffa09334  (/apex/com.android.art/lib64/libart.so+0x209334) (BuildId: 0c537e5efe426a30e9fde84241db9e3e)

 0x0038954d7458 is located 8 bytes inside of 24-byte region [0x0038954d7450,0x0038954d7468)
 freed by thread T0 (chromium.chrome) here:
     #0 0x75a091b000  (/system/lib64/libclang_rt.asan-aarch64-android.so+0xff000)
     #1 0x72ffa1a354  (/apex/com.android.art/lib64/libart.so+0x21a354) (BuildId: 0c537e5efe426a30e9fde84241db9e3e)
     #2 0x72fff1f714  (/apex/com.android.art/lib64/libart.so+0x71f714) (BuildId: 0c537e5efe426a30e9fde84241db9e3e)

 previously allocated by thread T0 (chromium.chrome) here:
     #0 0xfe780 __lsan::GetAdditionalThreadContextPtrsLocked(__sanitizer::InternalMmapVector<unsigned long>*) @ 'asan_thread.cpp:0:0'
     #1 0x7c1c168 autofill::AutofillSnackbarView::Create(autofill::AutofillSnackbarController*) @ './../../chrome/browser/ui/android/autofill/snackbar/autofill_snackbar_view_android.cc:27:10'
     #2 0x7c58e2c autofill::AutofillSnackbarControllerImpl::Show() @ './../../chrome/browser/ui/autofill/payments/autofill_snackbar_controller_impl.cc:28:31'
     #3 0x7b4f0b4 autofill::ChromeAutofillClient::OnVirtualCardDataAvailable(autofill::VirtualCardManualFallbackBubbleOptions const&) @ './../../chrome/browser/ui/autofill/chrome_autofill_client.cc:968:41'
     #4 0x70e5efc autofill::BrowserAutofillManager::OnCreditCardFetched(autofill::CreditCardFetchResult, autofill::CreditCard const*, std::__Cr::basic_string<char16_t, std::__Cr::char_traits<char16_t>, std::__Cr::allocator<char16_t>> const&) @ './../../components/autofill/core/browser/browser_autofill_manager.cc:1885:15'
     #5 0x7229c94 autofill::CreditCardAccessManager::OnVirtualCardUnmaskResponseReceived(autofill::AutofillClient::PaymentsRpcResult, autofill::payments::PaymentsClient::UnmaskResponseDetails&) @ './../../components/autofill/core/browser/payments/credit_card_access_manager.cc:1132:14'
     #6 0x722f040 void base::internal::Invoker<base::internal::BindState<void (autofill::CreditCardAccessManager::*)(autofill::AutofillClient::PaymentsRpcResult, autofill::payments::PaymentsClient::UnmaskResponseDetails&), base::WeakPtr<autofill::CreditCardAccessManager>>, void (autofill::AutofillClient::PaymentsRpcResult, autofill::payments::PaymentsClient::UnmaskResponseDetails&)>::RunImpl<void (autofill::CreditCardAccessManager::*)(autofill::AutofillClient::PaymentsRpcResult, autofill::payments::PaymentsClient::UnmaskResponseDetails&), std::__Cr::tuple<base::WeakPtr<autofill::CreditCardAccessManager>>, 0ul>(void (autofill::CreditCardAccessManager::*&&)(autofill::AutofillClient::PaymentsRpcResult, autofill::payments::PaymentsClient::UnmaskResponseDetails&), std::__Cr::tuple<base::WeakPtr<autofill::CreditCardAccessManager>>&&, std::__Cr::integer_sequence<unsigned long, 0ul>, autofill::AutofillClient::PaymentsRpcResult&&, autofill::payments::PaymentsClient::UnmaskResponseDetails&) @ './../../base/functional/bind_internal.h:1025:12'
     #7 0x722ee88 base::internal::Invoker<base::internal::BindState<void (autofill::CreditCardAccessManager::*)(autofill::AutofillClient::PaymentsRpcResult, autofill::payments::PaymentsClient::UnmaskResponseDetails&), base::WeakPtr<autofill::CreditCardAccessManager>>, void (autofill::AutofillClient::PaymentsRpcResult, autofill::payments::PaymentsClient::UnmaskResponseDetails&)>::RunOnce(base::internal::BindStateBase*, autofill::AutofillClient::PaymentsRpcResult, autofill::payments::PaymentsClient::UnmaskResponseDetails&) @ './../../base/functional/bind_internal.h:976:12'
     #8 0x72634ec base::OnceCallback<void (autofill::AutofillClient::PaymentsRpcResult, autofill::payments::PaymentsClient::UnmaskResponseDetails&)>::Run(autofill::AutofillClient::PaymentsRpcResult, autofill::payments::PaymentsClient::UnmaskResponseDetails&) && @ './../../base/functional/callback.h:152:12'
     #9 0x725409c autofill::payments::PaymentsClient::AccessTokenError(GoogleServiceAuthError const&) @ './../../components/autofill/core/browser/payments/payments_client.cc:516:15'
     #10 0x7256520 void base::internal::FunctorTraits<void (autofill::payments::PaymentsClient::*)(GoogleServiceAuthError, signin::AccessTokenInfo), void>::Invoke<void (autofill::payments::PaymentsClient::*)(GoogleServiceAuthError, signin::AccessTokenInfo), autofill::payments::PaymentsClient*, GoogleServiceAuthError, signin::AccessTokenInfo>(void (autofill::payments::PaymentsClient::*)(GoogleServiceAuthError, signin::AccessTokenInfo), autofill::payments::PaymentsClient*&&, GoogleServiceAuthError&&, signin::AccessTokenInfo&&) @ './../../base/functional/bind_internal.h:746:12'
     #11 0x7256278 void base::internal::InvokeHelper<false, void, 0ul>::MakeItSo<void (autofill::payments::PaymentsClient::*)(GoogleServiceAuthError, signin::AccessTokenInfo), std::__Cr::tuple<base::internal::UnretainedWrapper<autofill::payments::PaymentsClient, base::unretained_traits::MayNotDangle, (base::RawPtrTraits)0>>, GoogleServiceAuthError, signin::AccessTokenInfo>(void (autofill::payments::PaymentsClient::*&&)(GoogleServiceAuthError, signin::AccessTokenInfo), std::__Cr::tuple<base::internal::UnretainedWrapper<autofill::payments::PaymentsClient, base::unretained_traits::MayNotDangle, (base::RawPtrTraits)0>>&&, GoogleServiceAuthError&&, signin::AccessTokenInfo&&) @ './../../base/functional/bind_internal.h:925:12'
     #12 0x72560c4 void base::internal::Invoker<base::internal::BindState<void (autofill::payments::PaymentsClient::*)(GoogleServiceAuthError, signin::AccessTokenInfo), base::internal::UnretainedWrapper<autofill::payments::PaymentsClient, base::unretained_traits::MayNotDangle, (base::RawPtrTraits)0>>, void (GoogleServiceAuthError, signin::AccessTokenInfo)>::RunImpl<void (autofill::payments::PaymentsClient::*)(GoogleServiceAuthError, signin::AccessTokenInfo), std::__Cr::tuple<base::internal::UnretainedWrapper<autofill::payments::PaymentsClient, base::unretained_traits::MayNotDangle, (base::RawPtrTraits)0>>, 0ul>(void (autofill::payments::PaymentsClient::*&&)(GoogleServiceAuthError, signin::AccessTokenInfo), std::__Cr::tuple<base::internal::UnretainedWrapper<autofill::payments::PaymentsClient, base::unretained_traits::MayNotDangle, (base::RawPtrTraits)0>>&&, std::__Cr::integer_sequence<unsigned long, 0ul>, GoogleServiceAuthError&&, signin::AccessTokenInfo&&) @ './../../base/functional/bind_internal.h:1025:12'
     #13 0x3d277d8 base::OnceCallback<void (GoogleServiceAuthError, signin::AccessTokenInfo)>::Run(GoogleServiceAuthError, signin::AccessTokenInfo) && @ './../../base/functional/callback.h:152:12'
     #14 0x3d27394 signin::AccessTokenFetcher::RunCallbackAndMaybeDie(GoogleServiceAuthError, signin::AccessTokenInfo) @ './../../components/signin/public/identity_manager/access_token_fetcher.cc:186:24'
     #15 0x3d275e0 signin::AccessTokenFetcher::OnGetTokenFailure(OAuth2AccessTokenManager::Request const*, GoogleServiceAuthError const&) @ './../../components/signin/public/identity_manager/access_token_fetcher.cc:175:3'
     #16 0x1e1b44 void base::internal::Invoker<base::internal::BindState<void (OAuth2AccessTokenManager::RequestImpl::*)(GoogleServiceAuthError const&, OAuth2AccessTokenConsumer::TokenResponse const&), base::WeakPtr<OAuth2AccessTokenManager::RequestImpl>, GoogleServiceAuthError, OAuth2AccessTokenConsumer::TokenResponse>, void ()>::RunImpl<void (OAuth2AccessTokenManager::RequestImpl::*)(GoogleServiceAuthError const&, OAuth2AccessTokenConsumer::TokenResponse const&), std::__Cr::tuple<base::WeakPtr<OAuth2AccessTokenManager::RequestImpl>, GoogleServiceAuthError, OAuth2AccessTokenConsumer::TokenResponse>, 0ul, 1ul, 2ul>(void (OAuth2AccessTokenManager::RequestImpl::*&&)(GoogleServiceAuthError const&, OAuth2AccessTokenConsumer::TokenResponse const&), std::__Cr::tuple<base::WeakPtr<OAuth2AccessTokenManager::RequestImpl>, GoogleServiceAuthError, OAuth2AccessTokenConsumer::TokenResponse>&&, std::__Cr::integer_sequence<unsigned long, 0ul, 1ul, 2ul>) @ './../../base/functional/bind_internal.h:1025:12'
     #17 0x44f938 base::OnceCallback<void ()>::Run() && @ './../../base/functional/callback.h:152:12'
     #18 0x4a364c void base::TaskAnnotator::RunTask<base::sequence_manager::internal::ThreadControllerWithMessagePumpImpl::DoWorkImpl(base::LazyNow*)::$_0>(perfetto::StaticString, base::PendingTask&, base::sequence_manager::internal::ThreadControllerWithMessagePumpImpl::DoWorkImpl(base::LazyNow*)::$_0&&) @ './../../base/task/common/task_annotator.h:89:5'
     #19 0x4a29d0 base::sequence_manager::internal::ThreadControllerWithMessagePumpImpl::DoWork() @ './../../base/task/sequence_manager/thread_controller_with_message_pump_impl.cc:351:41'
     #20 0x5a951c base::MessagePumpForUI::DoNonDelayedLooperWork(bool) @ './../../base/message_loop/message_pump_android.cc:186:33'
     #21 0x5a83c8 base::MessagePumpForUI::OnNonDelayedLooperCallback() @ './../../base/message_loop/message_pump_android.cc:172:3'
     #22 0x75a026a7ac  (/system/lib64/libutils.so+0x177ac) (BuildId: a5ca39eaeeeb017be4afa358811e69fb)
     #23 0x75a026a328  (/system/lib64/libutils.so+0x17328) (BuildId: a5ca39eaeeeb017be4afa358811e69fb)
     #24 0x75a28e156c  (/system/lib64/libandroid_runtime.so+0x15a56c) (BuildId: 3be65de2801ea748ece61d980b1feba0)
     #25 0x70efd094  (/system/framework/arm64/boot-framework.oat+0x1b3094) (BuildId: ac9f071ed8093c88e0254d6f777e384b33bb81a3)

 SUMMARY: AddressSanitizer: heap-use-after-free (/data/app/~~X3DwWUPpCkdeLhUIPNXIlw==/org.chromium.chrome-6NOiZ12Mv7FFqN5GEh3foQ==/lib/arm64/libchrome.cr.so+0x7c1c090) (BuildId: 757b97741ec80657)
 Shadow bytes around the buggy address:
   0x0038954d7180: f7 fa fd fd fd fd fd fd f7 fa 00 00 00 fa fa fa
   0x0038954d7200: f7 fa 00 00 00 00 fa fa f7 fa 00 00 00 00 fa fa
   0x0038954d7280: f7 fa fd fd fd fd fd fd f7 fa 00 00 00 00 00 fa
   0x0038954d7300: f7 fa 00 00 00 00 00 fa f7 fa fa fa fa fa fa fa
   0x0038954d7380: f7 fa 00 00 00 00 fa fa f7 fa fd fd fd fd fd fa
 =>0x0038954d7400: f7 fa fd fd fd fd fd fd f7 fa fd[fd]fd fa fa fa
   0x0038954d7480: f7 fa fd fd fd fd fa fa f7 fa fd fd fd fd fd fa
   0x0038954d7500: f7 fa fd fd fd fd fa fa f7 fa fd fd fd fd fa fa
   0x0038954d7580: f7 fa fd fd fd fa fa fa f7 fa 00 00 00 00 fa fa
   0x0038954d7600: f7 fa fd fd fd fd fd fa f7 fa 00 00 00 00 00 fa
   0x0038954d7680: f7 fa fd fd fd fd fd fa f7 fa 00 00 00 fa fa fa
 Shadow byte legend (one shadow byte represents 8 application bytes):
   Addressable:           00
   Partially addressable: 01 02 03 04 05 06 07
   Heap left redzone:       fa
   Freed heap region:       fd
   Stack left redzone:      f1
   Stack mid redzone:       f2
   Stack right redzone:     f3
   Stack after return:      f5
   Stack use after scope:   f8
   Global redzone:          f9
   Global init order:       f6
   Poisoned by user:        f7
   Container overflow:      fc
   Array cookie:            ac
   Intra object redzone:    bb
   ASan internal:           fe
   Left alloca redzone:     ca
   Right alloca redzone:    cb

 ==6220==ADDITIONAL INFO

 ==6220==Note: Please include this section with the ASan report.
 Task trace:


 MiraclePtr Status: NOT PROTECTED
 No raw_ptr<T> access to this region was detected prior to this crash.
 This crash is still exploitable with MiraclePtr.
 Refer to https://chromium.googlesource.com/chromium/src/+/main/base/memory/raw_ptr.md for details.

 ==6220==END OF ADDITIONAL INFO
 ==6220==ABORTING